<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Central de Treinamento SpSkills <span id="appVersion" class="ver">v33</span></title>
  <link rel="stylesheet" href="./styles.v35.css" />
  <!-- CDNs -->
  <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
</head>
<body>

  <!-- Auth overlay (login/register) -->
  <div id="authOverlay" class="auth-overlay hidden" aria-hidden="true">
    <div class="auth-shell">
      <div class="auth-card">
        <div class="auth-header">
          <div class="auth-title" id="authTitle">Login</div>
        </div>

        <!-- Login -->
        <form id="loginForm" class="auth-form">
          <div class="auth-field">
            <div class="auth-ico">‚úâ</div>
            <input id="loginEmail" type="email" autocomplete="email" placeholder="Email" required />
          </div>
          <div class="auth-field">
            <div class="auth-ico">üîí</div>
            <input id="loginPass" type="password" autocomplete="current-password" placeholder="Password" required />
          </div>
          <button class="btn primary auth-btn" type="submit">Login</button>
          <div class="auth-links">
            <a href="#" id="goRegister">New member? Create an account</a>
          </div>
          <div class="auth-error" id="loginError"></div>
        </form>

        <!-- Register -->
        <form id="registerForm" class="auth-form hidden">
          <div class="auth-field">
            <div class="auth-ico">üë§</div>
            <input id="regName" type="text" autocomplete="name" placeholder="Name" required />
          </div>
          <div class="auth-field">
            <div class="auth-ico">‚úâ</div>
            <input id="regEmail" type="email" autocomplete="email" placeholder="Email" required />
          </div>
          <div class="auth-field">
            <div class="auth-ico">üîí</div>
            <input id="regPass" type="password" autocomplete="new-password" placeholder="Password" required />
          </div>
          <div class="auth-field">
            <div class="auth-ico">üîí</div>
            <input id="regPass2" type="password" autocomplete="new-password" placeholder="Confirm Password" required />
          </div>

          <label class="auth-check">
            <input id="regTerms" type="checkbox" />
            <span>Yes, I agree to the <span class="auth-accent">terms of service</span>.</span>
          </label>

          <button class="btn primary auth-btn" type="submit">Register</button>
          <div class="auth-links">
            <a href="#" id="goLogin">Already have an account? Sign in</a>
          </div>
          <div class="auth-error" id="registerError"></div>
        </form>
      </div>
    </div>
  </div>

  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <button id="sidebarToggle" class="icon-btn sidebar-toggle" title="Ocultar menu" aria-label="Ocultar menu">‚ùÆ</button>
        <div class="brand-badge">CT</div>
        <div class="brand-text">
          <div class="brand-title">Central de Treinamento</div>
          <div class="brand-subtitle">SpSkills</div>
        </div>
      </div>

      <nav class="nav">
        <button class="nav-item active" data-tab="schedule"><span class="nav-ico">üìÖ</span><span>Cronograma</span></button>
        <button class="nav-item" data-tab="tasks"><span class="nav-ico">üìã</span><span>Tarefas</span></button>
        <button class="nav-item" data-tab="timers"><span class="nav-ico">‚è±</span><span>Cron√¥metros</span></button>
        <button class="nav-item" data-tab="notes"><span class="nav-ico">üìù</span><span>Anota√ß√µes</span></button>
      </nav>
</aside>

    <main class="main">
      <button id="sidebarShow" class="icon-fab hidden" title="Mostrar menu" aria-label="Mostrar menu">‚ùØ</button>
      <header class="topbar">
        <div class="topbar-left">
          <div id="pageTitle" class="page-title">Cronograma</div>
          <div id="pageSubtitle" class="page-subtitle muted">Importe PNG/JPG, XLSX/XML ou PDF e use zoom/pan.</div>
        </div>
        <div class="topbar-right">
          <button id="btnExport" class="btn">Exportar dados</button>
          <label class="btn primary" for="importJson">Importar dados</label>
          <input id="importJson" type="file" accept="application/json" hidden />
          <button id="btnReset" class="btn danger">Reset</button>
        </div>
      </header>

      <!-- Cronograma -->
      <section id="tab-schedule" class="tab active">
        <div class="grid-2">
          <div class="panel">
            <div class="panel-title">Visualiza√ß√£o</div>
            <div class="panel-body schedule-view">
              <div id="scheduleEmpty" class="empty">
                <div class="empty-title">Nenhum cronograma carregado</div>
                <div class="empty-subtitle muted">Envie PNG/JPG, XLSX/XML ou PDF no painel da direita.</div>
              </div>

              <div id="viewer" class="viewer hidden">
                <div id="scheduleContent" class="schedule-content"></div>
              </div>

              <div class="viewer-toolbar">
                <button id="fitBtn" class="btn small">Ajustar</button>
                <button id="zoomInBtn" class="btn small">+</button>
                <button id="zoomOutBtn" class="btn small">-</button>
                <button id="resetViewBtn" class="btn small">Reset view</button>

                <div id="pdfPager" class="pdf-pager hidden">
                  <button id="pdfPrev" class="btn small">‚óÄ</button>
                  <span class="pdf-indicator"><span id="pdfPage">1</span>/<span id="pdfPages">1</span></span>
                  <button id="pdfNext" class="btn small">‚ñ∂</button>
                </div>

                <div class="muted small-text">Mouse wheel: zoom ‚Ä¢ Arrastar: pan</div>
              </div>
            </div>
          </div>

          <div class="panel">
            <div class="panel-title">Upload / Substituir</div>
            <div class="panel-body">
              <div class="form-row">
                <label class="label">Enviar cronograma (.png / .jpg / .xlsx / .xml / .pdf)</label>
                <div class="file-picker">
                  <input id="scheduleFile" type="file" hidden
                    accept="image/png,image/jpeg,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,.xml,text/xml,application/xml,.pdf,application/pdf" />
                  <button id="pickScheduleBtn" class="btn primary">Inserir cronograma</button>
                  <div id="scheduleFileName" class="file-name muted">Nenhum arquivo selecionado</div>
                </div>
                <div class="muted small-text">Planilhas renderizam como tabela (texto n√≠tido). PDF renderiza p√°ginas com navega√ß√£o.</div>
              </div>

              <div class="form-row">
                <label class="label">Op√ß√µes</label>
                <button id="removeScheduleBtn" class="btn danger">Remover cronograma</button>
              </div>
</div>
          </div>
        </div>
      </section>

      <!-- Tarefas -->
      <section id="tab-tasks" class="tab">
        <div class="panel">
          <div class="panel-title">Quadro de tarefas</div>
          <div class="panel-body">
            <div class="row" style="justify-content:space-between;align-items:center;">
              <div class="muted">Crie listas e tarefas. Clique na tarefa para anexos e etiquetas. Arraste tarefas entre listas.</div>
              <button id="addListBtn" class="btn primary">+ Nova lista</button>
            </div>
            <div id="board" class="board"></div>
          </div>
        </div>
      </section>

      <!-- Cron√¥metros -->
      <section id="tab-timers" class="tab">
        <div class="timers-header">
          <div>
            <div class="panel-title" style="margin:0;padding:0;border:none;">Cron√¥metros</div>
            <div class="muted small-text">Independentes das tarefas. Cron√¥metro (crescente) ou Temporizador (decrescente). ‚ÄúOcultar gr√°fico‚Äù remove a an√°lise.</div>
          </div>
          <div class="row">
            <div class="seg" role="tablist" aria-label="Filtrar">
              <button id="timerFilterStopwatch" class="seg-btn active" type="button" role="tab" aria-selected="true">Cron√¥metros</button>
              <button id="timerFilterCountdown" class="seg-btn" type="button" role="tab" aria-selected="false">Temporizadores</button>
            </div>
            <button id="createTimerBtn" class="btn primary">+ Novo</button>
          </div>
        </div>

        <div id="timerGrid" class="timer-grid"></div>
      </section>
        <!-- Anota√ß√µes -->
        <section id="tab-notes" class="tab">
          <div class="grid-2 notes-grid">
            <div class="panel">
              <div class="panel-title">Quadro</div>
              <div class="panel-body">
                <div class="notes-toolbar">
                  <button class="btn small" data-cmd="bold"><b>B</b></button>
                  <button class="btn small" data-cmd="italic"><i>I</i></button>
                  <button class="btn small" data-cmd="underline"><u>U</u></button>
                  <span class="divider"></span>
                  <button class="btn small" data-cmd="insertUnorderedList">‚Ä¢ Lista</button>
                  <button class="btn small" data-cmd="insertOrderedList">1. Lista</button>
                  <span class="divider"></span>
                  <button class="btn small" data-cmd="formatBlock" data-arg="H2">T√≠tulo</button>
                  <button class="btn small" data-cmd="formatBlock" data-arg="P">Par√°grafo</button>
                  <span class="divider"></span>
                  <button id="notesClearBtn" class="btn danger small">Limpar texto</button>
                </div>

                <div id="notesEditor" class="notes-editor" contenteditable="true" spellcheck="false" aria-label="Escreva suas anota√ß√µes aqui..."></div>
                <div class="muted small-text">Dica: seu conte√∫do fica salvo automaticamente (localmente, nesta vers√£o sem login).</div>
              </div>
            </div>

            <div class="panel">
              <div class="panel-title">Planilha simples</div>
              <div class="panel-body">
                <div class="sheet-toolbar">
                  <button id="sheetAddRow" class="btn small">+ Linha</button>
                  <button id="sheetDelRow" class="btn small">- Linha</button>
                  <span class="divider"></span>
                  <button id="sheetAddCol" class="btn small">+ Coluna</button>
                  <button id="sheetDelCol" class="btn small">- Coluna</button>
                  <span class="divider"></span>
                  <button id="cellBold" class="btn small"><b>B</b></button>
                  <button id="cellAlignLeft" class="btn small">‚ü∏</button>
                  <button id="cellAlignCenter" class="btn small">‚â°</button>
                  <button id="cellAlignRight" class="btn small">‚üπ</button>
                  <input id="cellBg" class="color-input" type="color" value="#5865f2" title="Cor do fundo" />
                  <span class="divider"></span>
                  <button id="sheetClear" class="btn danger small">Limpar planilha</button>
                </div>

                <div class="sheet-wrap">
                  <table id="notesSheet" class="sheet" aria-label="Planilha simples"></table>
                </div>

                <div class="muted small-text">Clique em uma c√©lula e digite. Use TAB/ENTER para navegar.</div>
              </div>
            </div>
          </div>

          <div class="panel" style="margin-top:12px;">
            <div class="panel-title">Anexos</div>
            <div class="panel-body">
              <div class="file-picker">
                <input id="notesFiles" type="file" multiple hidden />
                <button id="notesAddFileBtn" class="btn">Adicionar arquivos</button>
                <button id="notesRemoveAll" class="btn danger">Remover todos</button>
                <div id="notesFilesCount" class="file-name muted"></div>
              </div>
              <div id="notesFilesList" class="attachments"></div>
            </div>
          </div>
        </section>

      <footer class="footer muted"><span>(vers√£o sem login)</span><span class="footer-sep">‚Ä¢</span><span>Feito por #57 Manufatura Aditiva - 7.01 - Mhs</span></footer>
    </main>
  </div>

  <!-- Task Modal -->
  <div id="taskModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Detalhes da tarefa">
    <div class="modal-backdrop" id="taskModalClose"></div>
    <div class="modal-card">
      <div class="modal-header">
        <div class="modal-title">Detalhes da tarefa</div>
        <button class="icon-btn" id="taskModalX" title="Fechar">‚úñ</button>
      </div>

      <div class="modal-body">
        <div class="form-row">
          <label class="label">Nome da tarefa</label>
          <input id="taskModalTitle" class="input" type="text" />
          <div class="row" style="justify-content:flex-end;">
            <button id="taskModalSaveTitle" class="btn primary small">Salvar nome</button>
          </div>
        </div>

        <hr class="sep" />

        <div class="form-row">
          <div class="row" style="justify-content:space-between;align-items:center;">
            <div class="label" style="margin:0;">Etiquetas</div>
          </div>

          <div id="taskModalLabels" class="labels-wrap"></div>

          <div class="labels-panel">
            <div class="muted small-text">Marque/desmarque para aplicar na tarefa.</div>
            <div id="labelsChecklist" class="labels-checklist"></div>

            <div class="labels-editor">
              <div class="label" style="margin:10px 0 6px 2px;">Criar / editar etiqueta</div>
              <div class="row">
                <input id="labelName" class="input" placeholder="Nome" style="flex:1;min-width:180px" />
                <input id="labelColor" class="input" type="color" style="width:64px;padding:6px" />
                <button id="labelSave" class="btn primary small">Salvar</button>
                <button id="labelCancelEdit" class="btn small">Cancelar</button>
              </div>
              <div id="labelsList" class="labels-list"></div>
            </div>
          </div>
        </div>

        <hr class="sep" />

        <div class="form-row">
          <div class="row" style="justify-content:space-between;align-items:center;">
            <div class="label" style="margin:0;">Anexos</div>
            <label class="btn small" for="taskAttachInput">+ Adicionar</label>
            <input id="taskAttachInput" type="file" hidden />
          </div>
          <div id="taskAttachments" class="attachments"></div>
          <div class="muted small-text">Anexos ficam salvos localmente neste navegador.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Timer Create Modal -->
  <div id="timerCreateModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Novo cron√¥metro/temporizador">
    <div class="modal-backdrop" id="timerCreateClose"></div>
    <div class="modal-card">
      <div class="modal-header">
        <div class="modal-title">Novo cron√¥metro</div>
        <button class="icon-btn" id="timerCreateX" title="Fechar">‚úñ</button>
      </div>
      <div class="modal-body">
        <div class="form-row">
          <label class="label">Nome</label>
          <input id="timerNameInput" class="input" placeholder="Ex.: Modelagem, 10 minutos, An√°lise..." />
        </div>

        <div class="form-row">
          <label class="label">Tipo</label>
          <div class="row">
            <label class="btn small"><input type="radio" name="timerKind" value="stopwatch" checked /> Cron√¥metro</label>
            <label class="btn small"><input type="radio" name="timerKind" value="countdown" /> Temporizador</label>
          </div>
        </div>

        <div class="form-row" id="countdownSettings" style="display:none;">
          <label class="label">Dura√ß√£o (HH:MM:SS)</label>
          <div class="row">
            <input id="cdHours" class="input" type="number" min="0" value="0" style="width:90px" />
            <input id="cdMinutes" class="input" type="number" min="0" max="59" value="5" style="width:90px" />
            <input id="cdSeconds" class="input" type="number" min="0" max="59" value="0" style="width:90px" />
          </div>
        </div>

        <div class="row" style="justify-content:flex-end;margin-top:10px;">
          <button id="timerCreateSave" class="btn primary">Criar</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="./app.v35.js"></script>
</body>
</html>
